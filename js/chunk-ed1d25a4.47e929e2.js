(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ed1d25a4"],{"0ac8":function(e,t,a){},"1ea6":function(e,t,a){"use strict";var s=a("4bb5"),n=a.n(s);n.a},"2e3e":function(e,t,a){"use strict";var s=a("db81"),n=a.n(s);n.a},"3e8a":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"step-wrapper"},[a("Steps",{attrs:{current:e.step}},[a("Step",{attrs:{title:"Search",content:"Find your project to annotate"}}),a("Step",{attrs:{title:"Sample",content:"Give the number of samples"}}),a("Step",{attrs:{title:"Annotate",content:"Add the raw file"}})],1),a("p",{staticClass:"des"},[e._v("\n      "+e._s(e.des)+"\n    ")])],1)},n=[],o={name:"step",props:["step","des"],data:function(){return{}},mounted:function(){},created:function(){},beforeDestroy:function(){}},i=o,r=(a("1ea6"),a("2877")),c=Object(r["a"])(i,s,n,!1,null,"aa11043e",null);t["a"]=c.exports},"4bb5":function(e,t,a){},"6d78":function(e,t,a){"use strict";var s=a("0ac8"),n=a.n(s);n.a},"7a62":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"annotate-container"},[a("div",{staticClass:"browse-data-container"},[a("Row",[a("div",{staticClass:"title"},[e._v("\n                SDRF Annotation Tool\n            ")]),a("div",{staticClass:"step-wrapper"},[a("Step",{attrs:{step:e.annotationStep,des:e.stepDes}})],1)]),a("Row",[a("selfTable",{attrs:{name:e.name,height:e.tableHeight,loading:e.loading,columns:e.sampleCol,data:e.sampleData}}),a("div",{staticClass:"button-wrapper"},[a("div",{staticClass:"search-button"},[a("Button",{attrs:{type:"primary"},on:{click:e.back}},[e._v("Back")])],1),e.sampleCol.length>0&&e.sampleData.length>0?a("div",{staticClass:"search-button right"},[a("Button",{attrs:{type:"primary"},on:{click:e.annotationSave}},[e._v("Save")]),a("Button",{attrs:{type:"primary"},on:{click:e.annotationConfirm}},[e._v("Confirm")])],1):e._e()])],1)],1)])},n=[],o=(a("a481"),a("7f7f"),a("96cf"),a("3b8d")),i=a("3e8a"),r=a("1ea4"),c={name:"annotate",data:function(){return{name:"Sample Data",annotationStep:2,stepDes:"Here is used to put the explanation about steps",title:"",keyword:"",total:0,sampleCol:[],sampleData:[],loading:!1}},beforeRouteUpdate:function(e,t,a){a()},components:{Step:i["a"],selfTable:r["a"]},methods:{init:function(){var e=JSON.parse(localStorage.getItem("sampleData"));e&&(this.sampleData=e),this.experimentType=localStorage.getItem("selectedExperimentType"),this.sampleNumber=+localStorage.getItem("samplesNum"),this.fractionNumber=+localStorage.getItem("fractionsNum"),this.trNumber=+localStorage.getItem("trNum")},getSampleAttributes:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n,o,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,this.sampleData=[],this.sampleCol=[{name:"Accession",key:"accession",required:!0}],e.prev=3,e.next=6,this.$Api.getSampleAttributes();case 6:for(t=e.sent,this.loading=!1,a={},s=0;s<t.body.length;s++)t.body[s].first==this.experimentType&&(n={experimentType:t.body[s].first,required:"REQUIRED"==t.body[s].second,cvLabel:t.body[s].third.cvLabel.toLowerCase(),accession:t.body[s].third.accession,name:this.titleCase(t.body[s].third.name),orignal_name:t.body[s].third.name,key:this.titleCase(t.body[s].third.name).toLowerCase().replace(/\s/gi,"")},n.required&&this.sampleCol.push(n),this.newData.push(n),a[n.key]={value:"",dropdown:!1,accession:"null",accessionKey:this.accessionKey,cvLabel:"null",col:n,icon:"",checked:!0});if(o=localStorage.getItem("projectAccession"),!o)for(i=0;i<this.sampleNumber*this.fractionNumber;i++)r=JSON.parse(JSON.stringify(a)),r.accession={value:"PXD_S"+(i+1),dropdown:!1,accession:"null",accessionKey:this.accessionKey++,cvLabel:"null",col:this.sampleCol[0],icon:"",checked:!0},this.sampleData.push(r);e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](3),this.loading=!1,this.$Message.error({content:"Can not query Data",duration:3});case 18:case"end":return e.stop()}}),e,this,[[3,14]])})));function t(){return e.apply(this,arguments)}return t}(),back:function(){var e=this,t=localStorage.getItem("projectAccession");t?this.$Modal.confirm({title:"Uncompleted Annotaion",content:"<p>Do you want to delete the uncompleted annotation?</p>",onOk:function(){localStorage.clear(),e.$router.push({name:"index"})},onCancel:function(){}}):this.$router.push({path:"/sample/"+this.$route.params.id})},annotationConfirm:function(){var e=this;this.$Modal.confirm({title:"Finish Annotation",content:"<p>Do you want to submit this annotation?</p>",onOk:function(){e.$bus.$emit("annotation-confirm")},onCancel:function(){}})},annotationSave:function(){this.$bus.$emit("annotation-save")},localStorageCheck:function(){var e=localStorage.getItem("tempProjectAccession");e&&e!=this.$route.params.id&&(this.$Message.error({content:"Wrong Project Accession",duration:1}),this.$router.push({path:"/annotation"}));var t=+localStorage.getItem("samplesNum"),a=+localStorage.getItem("fractionsNum");this.total=t*a},confirm:function(){var e=!0,t=!0;console.log("this.sampleData",this.sampleData),console.log("this.msRunArray",this.msRunArray);for(var a=0;a<this.sampleData.length;a++)for(var s in this.sampleData[a])"accession"!=s?"accessionKey"!=s&&(!this.sampleData[a][s].value&&this.sampleData[a][s].col.required?(e=!1,this.sampleData[a][s].checked=!1):this.sampleData[a][s].checked=!0):this.sampleData[a][s];if(console.log("sampleDataCheckPass",e),console.log("msRunCheckPass",t),e){console.log("pass");for(var n=[],o=0;o<this.sampleData.length;o++){var i={};for(var r in i.projectAccession=this.$route.params.id,i.sampleAccession=this.sampleData[o].accession.value,i.sampleProperties=[],this.sampleData[o]){var c={};"accession"!=r&&"accessionKey"!=r&&"disable"!=r&&(c.key={},c.key.accession=this.sampleData[o][r].col.accession,c.key.cvLabel=this.sampleData[o][r].col.cvLabel,c.key.name=this.sampleData[o][r].col.name,c.key.value=this.sampleData[o][r].col.orignal_name,c.value={},c.value.accession=this.sampleData[o][r].accession,c.value.cvLabel=this.sampleData[o][r].cvLabel,c.value.name=this.sampleData[o][r].col.name,c.value.value=this.sampleData[o][r].value,i.sampleProperties.push(c))}i.msrunProperties=[];var l={accession:this.msRunArray[o].label.accession,cvLabel:this.msRunArray[o].label.cvLabel,name:this.msRunArray[o].label.value,value:""};i.sampleLabel=l;var u={accession:this.msRunArray[o].labelReagent.accession,cvLabel:this.msRunArray[o].labelReagent.cvLabel,name:this.msRunArray[o].labelReagent.value,value:""};i.labelReagent=u,this.sampleData[o].disable||n.push(i)}var p={SampleMSRunTable:{}};p.SampleMSRunTable.sampleMSRunRows=n,console.log("sendData",p),this.$http.put(this.updateSampleApi,p,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then((function(e){console.log("success",e),this.$Message.success({content:"Annotation Success",duration:1}),localStorage.clear(),this.$router.push({path:"/annotation"})}),(function(e){console.log("err",e),"TOKEN_EXPIRED"==e.body.error&&this.logout(),this.$Message.error({content:"Annotation Error",duration:1})}))}else this.$Message.error({content:"Fill required content",duration:1})},update:function(){},save:function(){var e=JSON.stringify(this.sampleData);this.sampleData.length>0&&this.localStorageItemAdd("sampleData",e),localStorage.setItem("projectAccession",this.$route.params.id),localStorage.setItem("selectedExperimentType",this.experimentType),localStorage.setItem("samplesNum",this.sampleNumber),localStorage.setItem("fractionsNum",this.fractionNumber),localStorage.setItem("trNum",this.trNumber),this.$Message.success({content:"Save Successfully",duration:1})}},watch:{},computed:{tableHeight:function(){var e=300;return this.screenHeight-180-138-20-55-32>e?this.screenHeight-180-138-20-55-32:e}},mounted:function(){var e=this;window.onresize=function(){e.screenHeight=document.documentElement.clientHeight},this.localStorageCheck()},created:function(){},beforeDestroy:function(){}},l=c,u=(a("6d78"),a("2e3e"),a("2877")),p=Object(u["a"])(l,s,n,!1,null,"7c3998ab",null);t["default"]=p.exports},db81:function(e,t,a){}}]);
//# sourceMappingURL=chunk-ed1d25a4.47e929e2.js.map